<!DOCTYPE html> 
<html>
<head>
	<meta charset="utf-8" />
	<title>Test</title>
	<script crossorigin src="https://unpkg.com/react@16/umd/react.production.min.js"></script>
	<script crossorigin src="https://unpkg.com/react-dom@16/umd/react-dom.production.min.js"></script>
	<script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/6.26.0/babel.min.js"></script>
	<script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/redux/4.0.0/redux.min.js"></script>
	<script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/react-redux/5.0.7/react-redux.min.js"></script>
</head>
<body>
	<div id="container"></div> 
	<script type="text/babel">

	//все изменения в redux должны быть имутабельными
	//https://doesitmutate.xyz/
	//////////////////-----------------------------
	//**actions/counter.js
		
		function addFriend (e) {
			return{
				type: "ADD_FRIEND",
				payload: {
					friend: e
				}
			}
		}
		
		function removeLastFriend () {
			return{
				type: "REMOVE_FRIEND",
			}
		}
	
	
	//////////////////-----------------------------
	//**reducers (index.js там храним все подключения в комбайне(комбинирует редюсеры в один ответ)
		//testReducer.js (который подключен к index.js)
		let initialState = {
			list: [],
		};
		
		const testReducer = (state = initialState, action) => {
			switch(action.type) {
				case "ADD_FRIEND": {
					return {
						...state,
						list: state.list.concat(action.payload.friend)
					}
				}
				case "REMOVE_FRIEND": {
					return {
						...state,
						list: state.list.slice(0, -1)
					}
				}
				default: return state;
			}
			return state;
		};
		
		//index.js
		const reducer = Redux.combineReducers({
			testReducer,
		});
	
	//////////////////-----------------------------
	//**store index.js 
		const store = Redux.createStore(reducer);
		
	//////////////////-----------------------------
	//***BLOCK TEST
	
		class Test extends React.Component {
			state = {
				text: '',
			};
			changeText = (e) => {
				this.setState({text: e.target.value});
			};
			addFriend = () => {
				this.props.addFriend(this.state.text);
			};
			removeFriend = () => {
				this.props.removeLastFriend();
			};
			render() {
				return (<React.Fragment>
					<input type="input" onChange={this.changeText} value={this.state.text}/>
					<input type="button" value="add" onClick={this.addFriend} />
					<input type="button" value="remove" onClick={this.removeFriend} />
					{this.props.friendList.map( (item, index) =>
					<div key={index}>{item}</div>
					)}
				</React.Fragment>);
			}
		}
		
		
		
		//export
		//1 аргумент это store 
		//2 аргумент - actionCreater
		const TestExport = ReactRedux.connect((state) => 
		{
			console.log('state', state);
			return {
				friendList: state.testReducer.list,
			}
		},
		{
			addFriend,
			removeLastFriend
		})(Test)
	
	//////////////////-----------------------------
	//***App Js
		ReactDOM.render(
				<ReactRedux.Provider store={store}>
					<TestExport/>
				</ReactRedux.Provider>
			,document.getElementById('container')
		);
	</script>
</body> 
</html>