<!DOCTYPE html> 
<html>
<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1"/>
	<title></title>
	<script src="000-react.production.min.js"></script>
	<script src="000-react-dom.production.min.js"></script>
	<script src="000-babel.min.js"></script>
</head>
<style>
	html {font-family: my; width: 100%; height: 100%; margin: 0;
	}
	body {height: 100%; width: 100%; margin: 0;
	}
	@font-face {
		font-family: my;
		src: url(RobotoSlab-VariableFont_wght.ttf);
	}

	#container {
		background: linear-gradient(to top, #fff1eb 0%, #ace0f9 100%); 
		height: 100%;
		display: flex; justify-content: center;}
	#main {overflow: auto; width: 100%; margin: 0 10px; max-width: 650px; position: relative;}
	#answerArea {width: 100%; height: 40px; font-size: 22px;}
	.additionalText { font-size: 12px; color: #444}
	.animOff { left: 3px; font-family: 'Arial'; top: 10px; font-size: 22px; position: absolute; z-index: -1; opacity: 0; }
	.animOn { left: 3px; font-family: 'Arial'; top: 10px; font-size: 22px; position: absolute; animation: fadeOut 4s; z-index: 2; opacity: 0; }
	@keyframes fadeOut {
		0% { opacity: 1; top: 10px}
		100% { opacity: 0; top: -20px}
	}
	.buttonWrap {
		padding: 20px;
		display: flex;
		gap: 10px;
		flex-direction: column;
	}
	.button {
		cursor: pointer;
		font-size: 22px;
		border: 1px solid black;
		border-radius: 10px;
		padding: 11px 22px;
		height: 34px
	}

</style>
<body>
	<div id="container"></div> 

	<!--

	// TODO+ рвзделить слова на блоки
	// паддинг справа и слева
	// Добавить секцию Песни (учим наизусь)
	// Секция слово  сочитания (Я работал я работаю я юуду раюотаь) он  не работал
	// + вопросы - когда / почему (загуглить самые часты вопросы и глаголы)

	-->

	<!-- ТЕКСТА -->
	<script src="texts.js"></script>

	<!-- СЛОВА -->
	<script src="wordsLess4.js"></script>
	<script src="wordsMore4.js"></script>
	<script type="text/babel">
		const WORDS = [
	
			// by, czy, ni, no, że, że
			// tobie, są, ja, ty, on, ona, ono, wy, oni, one, się
			// ci, mi, go, mu, ją, je, jej, im, ich, mnie, jego, jemu, nami, wami, ich, im
			
			// nas, tam, kto, co, gdy, raz, tak, nie, tu, te, to, ile, czy, lub, ani
			// ten, był, tego

			//  pan, mają, coś, lub, taki, nim, sam, nasze, wasz, tamtego, oraz, wszyscy, żaden, mój, niż, znowu, jakikolwiek, kogoś, powoli, właśnie, kochać, miłość, nikt, ktoś, czasami, móc, śmiać, gra, stąd, zapytać, słuchać, usłyszeć, widzieć, patrzeć, wstawać, siadać, lubić, nienawidzić, myśleć, rozumieć, pamiętać, zapomnieć, wszędzie, nigdzie, wewnątrz, na zewnątrz, w środku, na górze, na dole, po lewej, po prawej, szybko, wolno, źle, lepiej, gorzej, najgorzej, najpierw, później, wcześniej, wkrótce, długo, krótko, często, rzadko, prawie, chyba, na pewno, prawdopodobnie, raczej, z pewnością, bez wątpienia, absolutnie, naprawdę, rzeczywiście, oczywiście, pewnie, chociaż, jednak, mimo, albo, zarówno, ktoś, nikt, tak, aby, czasami, ponieważ, zatem, po prostu, tam, jedynie, rzeczy, swoje, wszystkich, jakieś, nowe, nasze, twoje, kilka, dni, noce, lata, tygodni, miesięcy, godzin, minut, sekund, wiesz, robi, mężczyzna, dziecko, samochód, książka, piosenka, praca, picie, chleb, masło, mleko, kawa, herbata, woda, piwo, wino, mięso, ryba, warzywa, owoce, zegarek, ubranie, buty, spodnie, koszula, bluzka, kurtka, płaszcz, czapka, rękawiczki, okulary, światło, dźwięk, biały, czarny, czerwony, zielony, niebieski, żółty, brązowy, szary, różowy, fioletowy, pomarańczowy, słońce, księżyc, gwiazdy, niebo, ziemia, morze, rzeka, jezioro, góra, las, łąka, pole, miasto, wieś, droga, ulica, most, budynek, sklep, mieszkanie, pokój, kuchnia, łazienka, salon, sypialnia, korytarz, okno, drzwi, podłoga, sufit, ściana, łóżko, stół, krzesło, fotel, kanapa, półka, szafa, dywan, firanka, zasłona, obraz, lustro, telewizor, pralka, lodówka, kuchenka, piekarnik, mikrofalówka, zlew, wanna, prysznic, toaleta, umywalka, szczotka, pasta, mydło, szampon, ręcznik, papier, nożyczki, nóż, widelec, łyżka, talerz, kubek, szklanka, butelka, miska, garnek, patelnia, czajnik, toster, blender, mikser, odkurzacz, żelazko, wiadro, mop, zmiotka, szufelka, worek, kosz, lampka, świeca, zapałka, zapalniczka, mysz, klawiatura, monitor, głośnik, słuchawki, drukarka, skaner, aparat, kamera, ładowarka, kabel, bateria, karta, pamięć, płyta, książka, zeszyt, długopis, ołówek, gumka, temperówka, linijka, ekierka, cyrkiel, klej, taśma, nożyczki, zszywacz, dziurkacz, notes, kalendarz, mapa, bilet, gazeta, czasopismo, list, koperta, znaczek, paczka, pudełko, torba, plecak, walizka, parasol, klucz, portfel, pieniądze, karta, bilet, dowód, paszport, legitymacja, licencja, certyfikat, dyplom, świadectwo, akt, dokument, kwit, rachunek, faktura, umowa, formularz, druk, wniosek, petycja, podanie, prośba, skarga, apel, wezwanie, ostrzeżenie, zgłoszenie, oświadczenie, deklaracja, zeznanie, raport, protokół, sprawozdanie, notatka, przypomnienie, zaproszenie, ogłoszenie, reklama, oferta, zamówienie, rezerwacja, potwierdzenie, zgoda, pozwolenie, akceptacja, odmowa, protest, wezwanie, mandat, kara, grzywna, skarga, apelacja, pozew, wyrok, postanowienie, orzeczenie, decyzja, polecenie, nakaz, zakaz, instrukcja, regulamin, kodeks, ustawa, prawo, przepis, zasada, reguła, standard, norma, procedura, protokół, umowa, kontrakt, porozumienie, pakt, układ, sojusz, traktat, konwencja, deklaracja, zgoda, kompromis, współpraca, partnerstwo, sojusz, koalicja, stowarzyszenie, organizacja, fundacja, instytut, agencja, departament, ministerstwo, ambasada, konsulat, misja, komisja, komitet, rada, zgromadzenie, parlament, senat, sejm, rząd, administracja, zarząd, dyrekcja, kierownictwo, sztab, komenda, inspektorat, nadzór, kontrola, audyt, rewizja, ocena, ekspertyza, analiza, badanie, test, sprawdzian, egzamin, kwalifikacja, selekcja, rekrutacja, nabor, zatrudnienie, praca, etat, stanowisko, posada, profesja, specjalność, funkcja, rola, zadanie, obowiązek, odpowiedzialność, kompetencja, uprawnienie, prawo, przywilej, przyjemność, korzyść, profit, zysk, premia, bonus, nagroda, gratyfikacja, odznaczenie, medal, order, tytuł, stopień, stanowisko, funkcja, ranga, status, prestiż, honor, reputacja, autorytet, sława, renoma, marka, imię, nazwisko, pseudonim, kryptonim, przydomek, ksywa, inicjały, tytuł, nagłówek, podtytuł, rozdział, sekcja, paragraf, ustęp, punkt, podpunkt, akapit, zdanie, fraza, wyrażenie, zwrot, słowo, litera, znak, symbol, ikona, piktogram, logo, emblemat, herb, godło, flaga, sztandar, chorągiew, proporzec, odznaka, plakietka, medalion, pieczęć, stempel, sygnet, tablica, tabliczka, szyld, napis, ogłoszenie, komunikat, wiadomość, nowina, plotka, ploteczka, wieść, pogłoska, słuch, słuchy, opowieść, historia, narracja, fabuła, scenariusz, dramat, komedia, tragedia, farsa, burleska, skecz, gag, dowcip, żart, kawał, anegdota, przysłowie, porzekadło, powiedzenie, maksymum, motto, hasło, slogan, dewiza, aforyzm, cytat, sentencja, fraza, frazes,
		];
	</script>

	<!-- WORDS -->
	<script type="text/babel">
		// PRE Words COMPONENT
		const PreWords = () => {
			const [type, setType] = React.useState(null);
			const TEST = [
				['1', '1'],
				['2', '2'],
				['3', '3'],
				['4', '4'],
				['5', '5'],
				['6', '6'],
				['7', '7'],
				['8', '8']
			];
			if (type) {
				return <Words propsWords={[...WORDS1, ...WORDS2]} />;
			}
			return <div className="buttonWrap">
				<div className="button" onClick={()=>setType(8)}>все слова</div>
			</div>;
			return <div className="buttonWrap">
				<div className="button">понедельник</div>
				<div className="button">вторник</div>
				<div className="button">среда</div>
				<div className="button">четверг</div>
				<div className="button">пятница</div>
				<div className="button">суббота</div>
				<div className="button">воскресенье</div>
			</div>;
		};
		// Words COMPONENT
		const Words = ({propsWords}) => {
			const textareaRef = React.useRef();

			// game mode
			const [gameMode, setGameMode] = React.useState('uniq'); // 'repeat' 'uniq'

			// words
			const [words, setWords] = React.useState([]);
			const wordsRef = React.useRef(words); // HERE will be imidiate state

			const TrueUpdateState = (newState) => {
				setWords(newState);
				wordsRef.current = newState;
			};

			const [inputContent, setInputContent] = useCustomState('');
			const [inputAnimContent, setInputAnimContent] = useCustomState('');
			const [inputAnimClass, setInputAnimClass] = useCustomState('animOff');

			const [mainQuestion, setMainQuestion] = React.useState([]);

			const [help, setHelp] = React.useState('');

			// right block
			const [timer, setTimer] = React.useState('0: 00');
			const [itemsLeft, setItemsLeft] = React.useState(null);

			// mistakes
			const [mistakesWords, setMistakesWords] = React.useState([]);

			// END
			const [isEnd, setEnd] = React.useState(false);

			const POLISH_LETTERS = ['ą', 'ć', 'ę', 'ł', 'ń', 'ó', 'ś', 'ź', 'ż'];

			const startNextWord = () => {
				if (wordsRef.current.length && gameMode === 'repeat') {
					const rnd = rand(0, wordsRef.current.length -1);

					setMainQuestion(wordsRef.current[rnd]);
				} else if (wordsRef.current.length && gameMode === 'uniq') {
					const rnd = rand(0, wordsRef.current.length -1);
					setMainQuestion([...wordsRef.current[rnd]]);
					TrueUpdateState(wordsRef.current.filter((_, i) => i !== rnd));
					setItemsLeft(wordsRef.current.length);
				}
			};

			const checkResult = () => {
				if (mainQuestion[0] === inputContent.toLowerCase().trim()) {
					VOICE_THE_TEXT(inputContent);
					setInputAnimContent(inputContent);
					setInputContent('');
					setInputAnimContent(inputContent);
					setInputAnimClass('animOn');
					setTimeout(() => {
						setInputAnimClass('animOff');
					}, 3000);
					console.log('--+ CORRECT --', mainQuestion[0]);
					setHelp('');
					
					// END
					if (words.length === 0) {
						setItemsLeft(0);
						setEnd(true);
						setMainQuestion('');
					}
					// NEXT WORD
					else {
						startNextWord();
						
					}
					
				} else {
					VOICE_THE_TEXT(mainQuestion[0]);
					setHelp(mainQuestion[0]);
					if (!mistakesWords.includes(mainQuestion[0])){
						setMistakesWords([...mistakesWords, mainQuestion[0]])
					}
					console.log('--+ INCORRECT --', mainQuestion[0]);
				}
				
			};

			const testArray = (words) => {
				let isArrayCorrupt = false;
				words.forEach(it => {
					if (!Array.isArray(it)) {
						isArrayCorrupt = true;
					}
				})
				if (isArrayCorrupt) {
					const container = document.getElementById("container");
					container.innerHTML = 'МАССИВ СЛОВ ПОВРЕЖДЕН (где-то пропущенна запятая)';
				}
			};

			React.useEffect(() => {
				// timer
				const start = Date.now();
				setInterval(() => {
					const delta = Math.round((Date.now() - start) / 1000);
					const minutes = Math.floor(delta / 60);
					const seconds = delta - minutes * 60;
					setTimer(`${minutes}: ${seconds.toString().length === 1 ? '0'+seconds : seconds}`)
				}, 1000)
				
				// --- START
				testArray(propsWords);
				TrueUpdateState(propsWords);
				startNextWord();
				
			}, []);

			return (
					<div id="main">
						<h2 style={{textAlign: 'center'}}>Учим Слова</h2>
						{/* TOP SECTION */}
						<div style={{display: 'flex', alignItems: 'center', justifyContent: 'center', gap: '10px'}}>
							<span style={{minWidth: '50px'}}>{timer}</span>
							<span style={{fontSize: '10px'}}> осталось слов:</span>
							<span style={{minWidth: '40px'}}>{`${itemsLeft}`}</span>
							
						</div>
						<br />
						<br />
						{/* CONTROL */} {/* QUESTION */} {/* END SCREEN */}
						{isEnd ? <div style={{ display: 'flex', alignContent: 'center', justifyContent: 'center', flexDirection: 'column'}}>
							<span style={{textAlign: 'center'}}>СЛОВА ЗАКОНЧИЛИСЬ!</span>
							<span style={{textAlign: 'center'}}>НЕ ЗАБУДЬТЕ ПРОПИСАТЬ СЛОВА В КОТОРЫХ СДЕЛАЛИ ОШИБКИ</span>
						</div> : 
						<div>
							<div className={'additionalText'} style={{display: 'flex', justifyContent: 'space-between', height: '20px'}}><div>вопрос</div><div>подсказка</div></div>
							<div style={{display: 'flex', justifyContent: 'space-between', height: '20px', borderTop: '1px solid black'}}><div>{mainQuestion[1]}</div><div>{help}</div></div>
						</div>
						}
						<br />

						{/* POLISH LETTERS */}
						<div style={{margin: '5px'}}>{POLISH_LETTERS.map(it => {
							return <span style={{margin: '5px', padding: '0 5px', border: '1px solid black'}} onClick={() => {
								let caret = textareaRef.current.selectionStart;

								setInputContent(inputContent.slice(0, caret) + it + inputContent.slice(caret), () => {
									textareaRef.current.focus();
									textareaRef.current.selectionStart = caret + 1;
									textareaRef.current.selectionEnd = caret + 1;
								})
							}}>{it}</span>
						})}</div>

						{/* INPUT */}
						<div style={{display: 'flex', position: 'relative'}}>
							<div style={{fontFamily: 'my'}} className={inputAnimClass}>{inputAnimContent}</div>
							<input
								style={{fontFamily: 'my'}}
								id="answerArea"
								ref={textareaRef}
								rows={10}
								value={inputContent}
								onKeyDown={e => {
									if (e.key === 'Enter') {
										checkResult();
									}
								}}
								onChange={e => {
									setInputContent(e.target.value)
								}}
							/>
							<button style={{fontFamily: 'my'}}
								onTouchEnd={e => {
									e.stopPropagation();
									e.preventDefault();
									checkResult(e);
								}}
								onClick={e => {
									e.stopPropagation();
									e.preventDefault();
									checkResult(e);
								}
							}>ОТВЕТИТЬ</button>
						</div>

						<div style={{paddingTop: '30px'}} className="additionalText">эти слова нужно прописать в строчку</div>
						<div style={{maxWidth: '650px', display: 'flex', flexWrap: 'wrap'}}>
							
							<div>{mistakesWords.map(it => <div style={{padding: '5px'}}>{it}</div>)}</div>
						</div>
					</div>
				);
		}
	</script>

	
	<!-- TEXTS -->
	<script type="text/babel">
		const SELECTED_TEXT = 'SELECTED_TEXT';
		const Texts = () => {
			// text0 ['pol', 'рус']
			const [selectedText, setSelectedText] = React.useState('t00');
			const allTexts = Object.keys(TEXTS);
			React.useEffect(() => {
					// --- LOCAL STORAGE
					const selText = localStorage.getItem(SELECTED_TEXT);
					if (selText) {
						setSelectedText(selText);
					}	
				}, []);
			const render = () => {
				if (!TEXTS[selectedText]) {
					return;
				}
				const plArr = TEXTS[selectedText].slice(0, TEXTS[selectedText].length / 2);
				const ruArr = TEXTS[selectedText].slice(TEXTS[selectedText].length / 2, TEXTS[selectedText].length);
				return (
					<div>{plArr.map((it, ind) => {
						return (
							<div style={{position: 'relative'}}>
								<div>
									<div onClick={() => VOICE_THE_TEXT(it)} style={{cursor: 'pointer', position: 'absolute', fontSize: '18px', border: '1px solid black', borderRadius: '4px', padding: '0 2px', marginTop: '7px'}}>⚟</div>
									<div style={{fontSize: '16px', paddingLeft: '20px', color: 'black'}}>{it}</div>
								</div>
								<div style={{fontSize: '14px', color: 'brown', paddingLeft: '20px', paddingBottom: '7px'}}>{ruArr[ind]}</div>
							</div>
							)})
						}
					</div>
				);
			};
			return (
				<div style={{maxWidth: '650px',overflow: 'auto'}}>
					<h2 style={{textAlign: 'center'}}>Читаем Текст</h2>
					<select style={{width: '150px'}} value={selectedText} onChange={e => {setSelectedText(e.target.value); localStorage.setItem(SELECTED_TEXT, e.target.value);}} id={selectedText}>
						{allTexts.map(it => {
							return <option onSelect={console.log} value={it}>{`text - ${it}`}</option>;
						})}
					</select>
					{render()}
				</div>
			);
		}
	</script>

	<!-- RADIO -->
	<script type="text/babel">
		const Radio = () => {
			return (
				<div>
					<h2 style={{textAlign: 'center'}}>Радио Онлайн</h2>
					<div>Просто слушать два часа в день</div>
					<audio controls src="https://27953.live.streamtheworld.com/RADIO_TOKFM.mp3"></audio>
				</div>
			)
		}
	</script>

	<!-- TV -->
	<script type="text/babel">
		const TV = () => {
			return (
				<div>
					<h2 style={{textAlign: 'center'}}>TV Онлайн</h2>
					<div>Просто смотреть один часа в день</div>
					<div>Включите суб-титры в настройках</div>
					<div>Каналы в которых бывают суб-титры (alfa tvp / tvp abc2 / TVP wilno )</div>
					<a href="https://vod.tvp.pl/na-zywo">Ссылка на сайт</a>
				</div>
			)
		}
	</script>

	<!-- YouTube chanels -->
	<script type="text/babel">
		const YoutubeChanels = () => {
			return (
				<div>
					<h2 style={{textAlign: 'center'}}>TV Онлайн</h2>
					<div>Просто смотреть один ролик в день</div>
					<div>Включите суб-титры в настройках</div>
					<div><a href="https://www.youtube.com/@UrbexHistory">UrbexHistory</a></div>
					<div><a href="https://www.youtube.com/@PlanetaAbstrakcja">PlanetaAbstrakcja</a></div>
					<div><a href="https://www.youtube.com/@HistoryHiking">HistoryHiking</a></div>
				</div>
			)
		}
	</script>

	<!-- STATE ROUTE UTILS-->
	<script type="text/babel">
		const VERSION = 0.7;
		const FILTER = ['pl-PL'];
		const SELECTED_LANG = 'SELECTED_LANG';
		// USE THIS OBJ to detect lang
		let lang = {};


		const VOICE_THE_TEXT = (txt) => {
			const selected = speechSynthesis.getVoices().find(it => it.voiceURI === lang);
			const msg = new SpeechSynthesisUtterance();
			msg.volume = 1;
			msg.rate = 0.8;
			msg.pitch = 1;
			msg.text = txt;
			msg.voice = selected;
			msg.voiceURI = selected.voiceURI;
			msg.lang = selected.lang;
			speechSynthesis.speak(msg);
		};

		// UTILS
		function useCustomState(init) {
			const [state, setState] = React.useState(init);
			const cbRef = React.useRef();

			const setCustomState = (newState, callback) => {
				cbRef.current = callback;
				setState(newState);
			};

			React.useEffect(() => {
				if (cbRef.current) {
					cbRef.current(state);
				}
				cbRef.current = undefined;
			}, [state]);

			return [state, setCustomState];
		}
		
		function rand(min, max) {
			let answer = Math.round(min - 0.5 + Math.random() * (max - min + 1));
			if(answer===0){
				answer=0;
			}
			return answer;
		};

		const Router = () => {
			const [Route, setRoute] = React.useState(null);
			const [allLang, setAllLang] = React.useState([]);
			const [selectedLang, setSelectedLang] = React.useState(null);

			React.useEffect(() => {
				// --- LOCAL STORAGE
				const selLang = localStorage.getItem(SELECTED_LANG);
				if (selLang) {
					setSelectedLang(selLang);
					lang = selLang;
				}

				// --- VOICE
				const setVoices = voicesArr => {
					const filteredVoices = voicesArr.filter(it => FILTER.includes(it.lang));
					if (Array.isArray(filteredVoices) && filteredVoices.length) {
						setAllLang(filteredVoices);
					} else {
						setAllLang(voicesArr);
					}
					if (!selLang) {
						setSelectedLang(filteredVoices[0].voiceURI);
						lang = filteredVoices[0].voiceURI;
					}
				};
				
				// firefox
				if (speechSynthesis.getVoices().length) {
					setVoices(speechSynthesis.getVoices());
				}
				// chrome
				speechSynthesis.addEventListener("voiceschanged", () => {
					setVoices(speechSynthesis.getVoices());
				})

				// for mobile chrome
				setTimeout(() => {
					setVoices(speechSynthesis.getVoices());
				}, 5000)		
			}, []);

			if (Route === 1) {
				return <PreWords />;
			}
			if (Route === 2) {
				return <Texts />;
			}
			if (Route === 3) {
				return <Radio />;
			}
			if (Route === 4) {
				return <TV />;
			}
			if (Route === 5) {
				return <YoutubeChanels />;
			}

			return (
				<div>
					<div className={'additionalText'} style={{textAlign: 'center', paddingBottom: '10px'}}>выберите польский язык<span style={{paddingLeft: '10px', fontSize: '10px'}}>v{VERSION}</span></div>
					<div style={{display: 'flex', alignItems: 'center', justifyContent: 'center', gap: '10px', paddingBottom: '10px'}}>
							<select style={{width: '150px'}} value={selectedLang} onChange={e => {lang = e.target.value; setSelectedLang(e.target.value); localStorage.setItem(SELECTED_LANG, e.target.value);}} id={selectedLang}>
								{allLang.map(it => {
									return <option onSelect={console.log} value={it.voiceURI}>{`${it.lang} ${it.name}`}</option>;
								})}
							</select>

					</div>
					<div className="buttonWrap">
						<div onClick={() => setRoute(1)} className="button">Слова</div>
						<div onClick={() => setRoute(2)} className="button">Текста</div>
						<div onClick={() => setRoute(3)} className="button">Радио</div>
						<div onClick={() => setRoute(4)} className="button">ТВ + субтитры</div>
						<div onClick={() => setRoute(5)} className="button">Youtube + субтитры</div>
					</div>
				</div>
			)
		}

		ReactDOM.render(
			<Router />
			,document.getElementById('container')
		);
	</script>
</body> 
</html>