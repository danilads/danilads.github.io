<!DOCTYPE html> 
<html>
<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1"/>
	<title></title>
	<script src="000-react.production.min.js"></script>
	<script src="000-react-dom.production.min.js"></script>
	<script src="000-babel.min.js"></script>
</head>
<style>
	html {font-family: my; width: 100%; height: 100%; margin: 0;
	}
	body {width: 100%; margin: 0;
		background: linear-gradient(to top, #fff1eb 0%, #ace0f9 100%); 
	}
	@font-face {
		font-family: my;
		src: url(RobotoSlab-VariableFont_wght.ttf);
	}

	#container {padding: 15px; display: flex; justify-content: center;}
	#main {width: 100%; margin: 0; max-width: 650px; position: relative;}
	#answerArea {width: 100%; height: 40px; font-size: 22px;}
	.additionalText { font-size: 12px; color: #444}
	.animOff { left: 3px; font-family: 'Arial'; top: 10px; font-size: 22px; position: absolute; z-index: -1; opacity: 0; }
	.animOn { left: 3px; font-family: 'Arial'; top: 10px; font-size: 22px; position: absolute; animation: fadeOut 4s; z-index: 2; opacity: 0; }
	@keyframes fadeOut {
		0% { opacity: 1; top: 10px}
		100% { opacity: 0; top: -20px}
	}

</style>
<body>
	<div id="container"></div> 
	<script type="text/babel">
	const SELECTED_LANG = 'SELECTED_LANG';

	// A
	// B
	// C
	// D
	// E
	// F
	// G
	// H
	// I
	// J
	// K
	// L
	// M
	// N
	// O
	// P
	// R
	// S
	// T
	// U
	// W
	// Z

	const W_PROF = [
		// A
		['architekt', 'архитектор'],
		// B
		// C
		// D
		['dentysta', 'дантист'],
		['dziennikarz', 'журналист'],
		// E
		// F
		['fotograf', 'фотограф'],
		// G
		// H
		// I
		// J
		// K
		['kelner', 'официант'],
		['kucharz', 'повар'],
		// L
		['lekarz', 'врач'],
		// M
		// N
		['nauczyciel', 'учитель'],
		// O
		// P
		// R
		// S
		// T
		// U
		['urzędnik', 'чиновник']
		// W
		// Z
	];

	const W_NUMB = [
		// A
		// B
		// C
		// D
		['dziesięć', 'десять'],
		// E
		// F
		// G
		// H
		// I
		// J
		// K
		// L
		// M
		// N
		// O
		// P
		['pierwszy', 'первый'],
		// R
		// S
		// T
		// U
		// W
		// Z
	];

	const W_COLOR = [
		// A
		// B
		['biały', 'белый'],
		['brązowy', 'коричневый'],
		// C
		['czarny', 'черный'],
		['czerwony', 'красный'],
		// D
		// E
		// F
		// G
		// H
		// I
		// J
		// K
		// L
		// M
		// N
		['niebieski', 'синий'],
		// O
		// P
		['pomarańczowy', 'оранжевый'],
		// R
		// S
		// T
		// U
		// W
		// Z
		['żółty', 'желтый'],
		['zielony', 'зеленый']
	];

	const W_NAME = [
		// A
		// B
		// C
		// D
		// E
		// F
		// G
		// H
		// I
		// J
		// K
		// L
		// M
		['my', 'мы'],
		// N
		// O
		// P
		// R
		// S
		['sobie', 'себе'],
		['siebie', 'себя'],
		// T
		// U
		// W
		// Z
	];
	const WORDS = [
        // A
		['a', 'а'],
		['ale', 'но'],
        // B
		['bez', 'без'],
		['blisko', 'близко'],
		['biuro', 'бюро'],
		['bardzo', 'очень'],
        // C
		['co', 'что'],
		['cześć', 'привет'],
        // D
		['do', 'к'],
		['dla', 'для'],
		['dzisiaj', 'сегодня'],
		['dom', 'дом'],
		['dokumenty', 'документы'],
		['dziękuję', 'спасибо'],
		['dopóki', 'пока'],
		['daleko', 'далеко'],
		
        // E
		// F
		['fotografia', 'фотография'],
		['firma', 'фирма'],
		// G
		['gdzie', 'где'],
		['gabinet', 'кабинет'],
		['gotować', 'готовить'],
		// H
		['hotel', 'отель'],
		// I
		['i', 'и'],
		['informacja', 'информация'],
		// J
		['już', 'уже'],
		['jak', 'как'],
		['jest', 'есть'],
		['język', 'язык'],
		['jedzenie', 'еда'],
		
		// K
		['kraj', 'страна'],
		['który', 'который'],
		['kolor', 'цвет'],
		['konkretny', 'конкретный'],
		['komputer', 'компьютер'],
		['kryzys', 'кризис'],
		['kiedy', 'когда'],
		// L
		['leczyć', 'лечить'],
		['ludzie', 'люди'],
		// M
		['ma', 'имеет'],
		['między', 'между'],
		['mniej', 'меньше'],
		['mówić', 'говорить'],
		// N
		['na', 'на'],
		['nad', 'над'],
		['nie', 'нет'],
		['naprzeciw', 'напротив'],
		['niedaleko', 'недалеко'],
		['nawet', 'даже'],
		['niżej', 'ниже'],
		// O
		['o', 'о'],
		['od', 'от'],
		['obok', 'рядом'],
		['około', 'около'],
		['oprócz', 'кроме'],
		['osoba', 'человек'],
		['ostatni', 'последний'],
		['odpowiedzieć', 'ответить'],
		
		// P
		['po', 'после'],
		['pod', 'под'],
		['poza', 'вне'],
		['podczas', 'во время'],
		['pisać', 'писать'],

	
		['poznać', 'познать'],
		['popularny', 'популярный'],
		['powiedzieć', 'сказать'],
		
		['przy', 'при'],
		['przez', 'через'],
		['przed', 'перед'],
		['przeciw', 'против'],
		['pracuje', 'работает'],
		['prezentować', 'презентовать'],
		['pracować', 'работать'],
		['program', 'программа'],
		['projektować', 'проектировать'],
		['przygotować', 'приготовить'],

		['pytanie', 'вопрос'],
		// R
		['robić', 'делать'],
		['restauracja', 'ресторан'],
		['radio', 'радио'],
		['rysunek', 'рисунок'],
		// S
		['szpital', 'больница'],
		['student', 'студент'],
		['szkoła', 'школа'],
		['serwuje', 'сервирует'],
		['studio', 'студия'],
		['sprzeciw', 'возражение'],
		// T
		['to', 'это'],
		['telewizja', 'телевизор'],
		['telefon', 'телефон'],
		// U
		['u', 'у'],
		['kochany', 'любимый'],
		['uczy', 'учит'],
		['uczeń', 'ученик'],
		['urząd', 'учреждение'],
		['uwaga', 'внимание'],
		['uniwersytet', 'университет'],
		// W
		['w', 'в'],
		['wśród', 'среди'],
		['wzdłuż', 'вдоль'],
		['wokół', 'вокруг'],
		['więcej', 'больше'],
		['wyżej', 'выше'],
		// Z
		['z', 'из'],
		['za', 'за'],
		['zamiast', 'вместо'],
		['zawód', 'профессия'],
		['zaczynać', 'начинать'],
		['zęby', 'зубы'],
		['zwierzę', 'животное']
		
		// bo, by, czy, , ni, no, że, że
		// W_NAME
		// ja, ty, on, ona, ono, wy, oni, one, się, ci, mi, go, mu, ją, je, jej, im, ich, mnie, ciebie, jego, jemu, nami, wami, ich, im
		
		// tam, kto, co, gdy, raz, tak, nie, tu, te, to, gdy, ile, czy, lub, ani
		// ten, był, dobrze, tylko, tego, tutaj, jeszcze, jeśli

        //  go, są, jeśli, bo, może, było, tobie, będzie, nas, kto, tam, każdy, nic, bardziej, ani, pan, mają, trzeba, coś, nigdy, lub, zawsze, taki, nim, też, być, mieć, czas, potem, czego, wiedzieć, teraz, sam, gdy, nasze, wasz, tamtego, oraz, wszyscy, wszystko, żaden, mój, niż, znowu, wielki, jakikolwiek, zaraz, kogoś, powoli, właśnie, czekać, kochać, miłość, nikt, trochę, ktoś, czasami, móc, śmiać, grać, gra, stąd, zapytać, słuchać, usłyszeć, widzieć, patrzeć, wstawać, siadać, lubić, nienawidzić, myśleć, rozumieć, pamiętać, zapomnieć, wszędzie, nigdzie, wewnątrz, na zewnątrz, w środku, na górze, na dole, po lewej, po prawej, szybko, wolno, źle, lepiej, gorzej, najgorzej, najpierw, później, wcześniej, wkrótce, długo, krótko, często, rzadko, prawie, chyba, na pewno, prawdopodobnie, raczej, z pewnością, bez wątpienia, absolutnie, naprawdę, rzeczywiście, oczywiście, pewnie, chociaż, jednak, mimo, albo, zarówno, każdy, ktoś, nikt, tak, aby, czasami, ponieważ, zatem, po prostu, teraz, tam, jedynie, rzeczy, swoje, wszystkich, jakieś, nowe, nasze, twoje, kilka, dni, noce, lata, tygodni, miesięcy, godzin, minut, sekund, wiesz, robi, mężczyzna, kobieta, dziecko, samochód, książka, piosenka, praca, picie, chleb, masło, mleko, kawa, herbata, woda, piwo, wino, mięso, ryba, warzywa, owoce, zegarek, ubranie, buty, spodnie, koszula, bluzka, kurtka, płaszcz, czapka, rękawiczki, okulary, światło, dźwięk, biały, czarny, czerwony, zielony, niebieski, żółty, brązowy, szary, różowy, fioletowy, pomarańczowy, słońce, księżyc, gwiazdy, niebo, ziemia, morze, rzeka, jezioro, góra, las, łąka, pole, miasto, wieś, droga, ulica, most, budynek, sklep, mieszkanie, pokój, kuchnia, łazienka, salon, sypialnia, korytarz, okno, drzwi, podłoga, sufit, ściana, łóżko, stół, krzesło, fotel, kanapa, półka, szafa, dywan, firanka, zasłona, obraz, lustro, telewizor, pralka, lodówka, kuchenka, piekarnik, mikrofalówka, zlew, wanna, prysznic, toaleta, umywalka, szczotka, pasta, mydło, szampon, ręcznik, papier, nożyczki, nóż, widelec, łyżka, talerz, kubek, szklanka, butelka, miska, garnek, patelnia, czajnik, toster, blender, mikser, odkurzacz, żelazko, wiadro, mop, zmiotka, szufelka, worek, kosz, lampka, świeca, zapałka, zapalniczka, mysz, klawiatura, monitor, głośnik, słuchawki, drukarka, skaner, aparat, kamera, ładowarka, kabel, bateria, karta, pamięć, płyta, książka, zeszyt, długopis, ołówek, gumka, temperówka, linijka, ekierka, cyrkiel, klej, taśma, nożyczki, zszywacz, dziurkacz, notes, kalendarz, mapa, bilet, gazeta, czasopismo, list, koperta, znaczek, paczka, pudełko, torba, plecak, walizka, parasol, klucz, portfel, pieniądze, karta, bilet, dowód, paszport, legitymacja, licencja, certyfikat, dyplom, świadectwo, akt, dokument, kwit, rachunek, faktura, umowa, formularz, druk, wniosek, petycja, podanie, prośba, skarga, apel, wezwanie, ostrzeżenie, zgłoszenie, oświadczenie, deklaracja, zeznanie, raport, protokół, sprawozdanie, notatka, przypomnienie, zaproszenie, ogłoszenie, reklama, oferta, zamówienie, rezerwacja, potwierdzenie, zgoda, pozwolenie, akceptacja, odmowa, protest, wezwanie, mandat, kara, grzywna, skarga, apelacja, pozew, wyrok, postanowienie, orzeczenie, decyzja, polecenie, nakaz, zakaz, instrukcja, regulamin, kodeks, ustawa, prawo, przepis, zasada, reguła, standard, norma, procedura, protokół, umowa, kontrakt, porozumienie, pakt, układ, sojusz, traktat, konwencja, deklaracja, zgoda, kompromis, współpraca, partnerstwo, sojusz, koalicja, stowarzyszenie, organizacja, fundacja, instytut, agencja, departament, ministerstwo, ambasada, konsulat, misja, komisja, komitet, rada, zgromadzenie, parlament, senat, sejm, rząd, administracja, zarząd, dyrekcja, kierownictwo, sztab, komenda, inspektorat, nadzór, kontrola, audyt, rewizja, ocena, ekspertyza, analiza, badanie, test, sprawdzian, egzamin, kwalifikacja, selekcja, rekrutacja, nabor, zatrudnienie, praca, etat, stanowisko, posada, profesja, specjalność, funkcja, rola, zadanie, obowiązek, odpowiedzialność, kompetencja, uprawnienie, prawo, przywilej, przyjemność, korzyść, profit, zysk, premia, bonus, nagroda, gratyfikacja, odznaczenie, medal, order, tytuł, stopień, stanowisko, funkcja, ranga, status, prestiż, honor, reputacja, autorytet, sława, renoma, marka, imię, nazwisko, pseudonim, kryptonim, przydomek, ksywa, inicjały, tytuł, nagłówek, podtytuł, rozdział, sekcja, paragraf, ustęp, punkt, podpunkt, akapit, zdanie, fraza, wyrażenie, zwrot, słowo, litera, znak, symbol, ikona, piktogram, logo, emblemat, herb, godło, flaga, sztandar, chorągiew, proporzec, odznaka, plakietka, medalion, pieczęć, stempel, sygnet, tablica, tabliczka, szyld, napis, ogłoszenie, komunikat, wiadomość, nowina, plotka, ploteczka, wieść, pogłoska, słuch, słuchy, opowieść, historia, narracja, fabuła, scenariusz, dramat, komedia, tragedia, farsa, burleska, skecz, gag, dowcip, żart, kawał, anegdota, przysłowie, porzekadło, powiedzenie, maksymum, motto, hasło, slogan, dewiza, aforyzm, cytat, sentencja, fraza, frazes,
    ];
	
	// UTILS
	function useCustomState(init) {
		const [state, setState] = React.useState(init);
		const cbRef = React.useRef();

		const setCustomState = (newState, callback) => {
			cbRef.current = callback;
			setState(newState);
		};

		React.useEffect(() => {
			if (cbRef.current) {
				cbRef.current(state);
			}
			cbRef.current = undefined;
		}, [state]);

		return [state, setCustomState];
	}
	
	function rand(min, max) {
		let answer = Math.round(min - 0.5 + Math.random() * (max - min + 1));
		if(answer===0){
			answer=0;
		}
		return answer;
	};

	// MAIN COMPONENT
	const Main = () => {
		const textareaRef = React.useRef();

		// game mode
		const [gameMode, setGameMode] = React.useState('uniq'); // 'repeat' 'uniq'

		// words
		const [words, setWords] = React.useState([]);
		const wordsRef = React.useRef(words); // HERE will be imidiate state

		const TrueUpdateState = (newState) => {
			setWords(newState);
			wordsRef.current = newState;
		};

		// lang
		const [allLang, setAllLang] = React.useState([]);
		const [selectedLang, setSelectedLang] = React.useState(null);

		const [inputContent, setInputContent] = useCustomState('');
		const [inputAnimContent, setInputAnimContent] = useCustomState('');
		const [inputAnimClass, setInputAnimClass] = useCustomState('animOff');

		const [mainQuestion, setMainQuestion] = React.useState([]);

		const [help, setHelp] = React.useState('');

		// right block
		const [timer, setTimer] = React.useState('0: 00');
		const [itemsLeft, setItemsLeft] = React.useState(null);

		// mistakes
		const [mistakesWords, setMistakesWords] = React.useState([]);

		// test
		const [test, setTest] = React.useState('v0.5');

		// END
		const [isEnd, setEnd] = React.useState(false);

		// фильтр языков
		const FILTER = ['pl-PL', 'en-US'];
		const POLISH_LETTERS = ['ą', 'ć', 'ę', 'ł', 'ń', 'ó', 'ś', 'ź', 'ż'];

		const startNextWord = () => {
			if (wordsRef.current.length && gameMode === 'repeat') {
				const rnd = rand(0, wordsRef.current.length -1);

				setMainQuestion(wordsRef.current[rnd]);
			} else if (wordsRef.current.length && gameMode === 'uniq') {
				const rnd = rand(0, wordsRef.current.length -1);
				setMainQuestion([...wordsRef.current[rnd]]);
				TrueUpdateState(wordsRef.current.filter((_, i) => i !== rnd));
				setItemsLeft(wordsRef.current.length);
			}
		};

		const checkResult = () => {
			if (mainQuestion[0] === inputContent.toLowerCase().trim()) {
				listenTextarea(inputContent);
				setInputAnimContent(inputContent);
				setInputContent('');
				setInputAnimContent(inputContent);
				setInputAnimClass('animOn');
				setTimeout(() => {
					setInputAnimClass('animOff');
				}, 3000);
				console.log('--+ CORRECT --', mainQuestion[0]);
				setHelp('');
				
				// END
				if (words.length === 0) {
					setItemsLeft(0);
					setEnd(true);
					setMainQuestion('');
				}
				// NEXT WORD
				else {
					startNextWord();
					
				}
				
			} else {
				listenTextarea(mainQuestion[0]);
				setHelp(mainQuestion[0]);
				if (!mistakesWords.includes(mainQuestion[0])){
					setMistakesWords([...mistakesWords, mainQuestion[0]])
				}
				console.log('--+ INCORRECT --', mainQuestion[0]);
			}
			
		};

		const listenTextarea = (txt) => {
			const selected = speechSynthesis.getVoices().find(it => it.voiceURI === selectedLang);
			const msg = new SpeechSynthesisUtterance();
			msg.volume = 1;
			msg.rate = 0.8;
			msg.pitch = 1;
			msg.text = txt;
			msg.voice = selected;
			msg.voiceURI = selected.voiceURI;
    		msg.lang = selected.lang;
			speechSynthesis.speak(msg);
		};

		const testArray = (words) => {
			let isArrayCorrupt = false;
			words.forEach(it => {
				if (!Array.isArray(it)) {
					isArrayCorrupt = true;
				}
			})
			if (isArrayCorrupt) {
				const container = document.getElementById("container");
				container.innerHTML = 'МАССИВ СЛОВ ПОВРЕЖДЕН (где-то пропущенна запятая)';
			}
		};

		React.useEffect(() => {
			// --- LOCAL STORAGE
			const selLang = localStorage.getItem(SELECTED_LANG);
			if (selLang) setSelectedLang(selLang);

			// --- VOICE
			const setVoices = voicesArr => {
				const filteredVoices = voicesArr.filter(it => FILTER.includes(it.lang));
				if (Array.isArray(filteredVoices) && filteredVoices.length) {
					setAllLang(filteredVoices);
				} else {
					setAllLang(voicesArr);
				}
				if (!selLang) setSelectedLang(filteredVoices[0].voiceURI);
			};
			
			// firefox
			if (speechSynthesis.getVoices().length) {
				setVoices(speechSynthesis.getVoices());
			}
			// chrome
			speechSynthesis.addEventListener("voiceschanged", () => {
				setVoices(speechSynthesis.getVoices());
			})

			// for mobile chrome
			setTimeout(() => {
				setVoices(speechSynthesis.getVoices());
			}, 5000)
			
			// timer
			const start = Date.now();
			setInterval(() => {
				const delta = Math.round((Date.now() - start) / 1000);
				const minutes = Math.floor(delta / 60);
				const seconds = delta - minutes * 60;
				setTimer(`${minutes}: ${seconds.toString().length === 1 ? '0'+seconds : seconds}`)
			}, 1000)
			
			// --- START
			testArray(WORDS);
			TrueUpdateState(WORDS);
			startNextWord();
			
		}, []);

		return (
				<div id="main">
					{/* TOP SECTION */}
					<div className={'additionalText'} style={{textAlign: 'center', paddingBottom: '10px'}}>1выберите польский язык</div>
					<div style={{display: 'flex', alignItems: 'center', justifyContent: 'center', gap: '10px'}}>
						<select style={{width: '150px'}} value={selectedLang} onChange={e => {setSelectedLang(e.target.value); localStorage.setItem(SELECTED_LANG, e.target.value);}} id={selectedLang}>
							{allLang.map(it => {
								return <option onSelect={console.log} value={it.voiceURI}>{`${it.lang} ${it.name}`}</option>;
							})}
						</select>
				
						<span style={{minWidth: '40px'}}>{timer}</span>
						<span style={{minWidth: '40px'}}>{`${itemsLeft} ( ${WORDS.length } / ${mistakesWords.length} )`}</span>

					</div>
	
					{/* TEST */}
					<div>
						<span>{test}</span>
					</div>

					<br />
					<br />
					<br />
					{/* CONTROL */} {/* QUESTION */} {/* END SCREEN */}
					{isEnd ? <div style={{ display: 'flex', alignContent: 'center', justifyContent: 'center', flexDirection: 'column'}}>
						<span style={{textAlign: 'center'}}>СЛОВА ЗАКОНЧИЛИСЬ!</span>
						<span style={{textAlign: 'center'}}>НЕ ЗАБУДЬТЕ ПРОПИСАТЬ СЛОВА В КОТОРЫХ СДЕЛАЛИ ОШИБКИ</span>
					</div> : 
					<div>
						<div className={'additionalText'} style={{display: 'flex', justifyContent: 'space-between', height: '20px'}}><div>вопрос</div><div>подсказка</div></div>
						<div style={{display: 'flex', justifyContent: 'space-between', height: '20px', borderTop: '1px solid black'}}><div>{mainQuestion[1]}</div><div>{help}</div></div>
					</div>
					}
					<br />

					{/* POLISH LETTERS */}
					<div style={{margin: '5px'}}>{POLISH_LETTERS.map(it => {
						return <span style={{margin: '5px', padding: '0 5px', border: '1px solid black'}} onClick={() => {
							let caret = textareaRef.current.selectionStart;

							setInputContent(inputContent.slice(0, caret) + it + inputContent.slice(caret), () => {
								textareaRef.current.focus();
								textareaRef.current.selectionStart = caret + 1;
								textareaRef.current.selectionEnd = caret + 1;
							})
						}}>{it}</span>
					})}</div>

					{/* INPUT */}
					<div style={{display: 'flex', position: 'relative'}}>
						<div style={{fontFamily: 'my'}} className={inputAnimClass}>{inputAnimContent}</div>
						<input
							style={{fontFamily: 'my'}}
							id="answerArea"
							ref={textareaRef}
							rows={10}
							value={inputContent}
							onKeyDown={e => {
								if (e.key === 'Enter') {
									checkResult();
								}
							}}
							onChange={e => {
								setInputContent(e.target.value)
							}}
						/>
						<button style={{fontFamily: 'my'}}
							onTouchEnd={e => {
								e.stopPropagation();
								e.preventDefault();
								checkResult(e);
							}}
							onClick={e => {
								e.stopPropagation();
								e.preventDefault();
								checkResult(e);
							}
						}>ОТВЕТИТЬ</button>
					</div>

					<div style={{paddingTop: '30px'}} className="additionalText">эти слова нужно прописать в строчку</div>
					<div style={{maxWidth: '650px', display: 'flex', flexWrap: 'wrap'}}>
						
						<div>{mistakesWords.map(it => <div style={{padding: '5px'}}>{it}</div>)}</div>
					</div>
				</div>
			);
	}
	////////////////App Js
		ReactDOM.render(
			<Main />
			,document.getElementById('container')
		);
	</script>
</body> 
</html>